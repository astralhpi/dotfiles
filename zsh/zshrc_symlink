source $HOME/.local/share/zinit/zinit.git/zinit.zsh

# z-a-bin-gem-node
zinit light zdharma-continuum/zinit-annex-bin-gem-node
zinit light zdharma-continuum/zinit-annex-patch-dl

# prezto
zstyle ':prezto:module:editor' key-bindings 'vi'
zstyle ':prezto:module:terminal' auto-title 'yes'
zstyle ':prezto:module:utility:ls' color 'yes'
zstyle ':prezto:module:utility:ls' dirs-first 'yes'
zstyle ':prezto:module:utility:grep' color 'yes'
zstyle ':prezto:module:utility:diff' color 'yes'
zstyle ':prezto:module:utility:make' color 'yes'


zinit snippet PZTM::environment
zinit ice wait lucid
zinit snippet PZTM::completion
zinit ice wait lucid
zinit snippet PZTM::directory
zinit snippet PZTM::editor
zinit ice wait lucid
zinit snippet PZTM::gnu-utility
zinit ice wait lucid
zinit snippet PZTM::utility

# vim mode
zinit ice depth=1
zinit light jeffreytse/zsh-vi-mode

# oh-my-zsh
zinit ice wait lucid
zinit snippet OMZP::fzf

# forgit
zinit ice wait lucid
zinit light wfxr/forgit

# zsh-completions & fast-syntax-highlighting
zinit wait lucid for \
 atinit"ZINIT[COMPINIT_OPTS]=-C; zicompinit; zicdreplay" \
    zdharma-continuum/fast-syntax-highlighting \
 blockf \
    zsh-users/zsh-completions \
 atload"!_zsh_autosuggest_start" \
    zsh-users/zsh-autosuggestions

# direnv
zinit ice from"gh-r" as"program" bpick"*arm*" mv"direnv* -> direnv" \
    atclone'./direnv hook zsh > zhook.zsh' atpull'%atclone' \
    pick"direnv" src="zhook.zsh"
zinit light direnv/direnv

# pyenv
zinit wait lucid as'program' pick'bin/pyenv' atinit'export PYENV_ROOT="$PWD"' \
    atclone'PYENV_ROOT="$PWD" ./libexec/pyenv init - > zpyenv.zsh' \
    atpull"%atclone" src"zpyenv.zsh" nocompile'!' for \
        pyenv/pyenv
export PATH="$HOME/.zinit/plugins/pyenv---pyenv/shims:${PATH}"

# nvm
zinit wait lucid as'program' src='zsh-nvm.plugin.zsh' nocompile'!' for lukechilds/zsh-nvm

# fzf
export FZF_DEFAULT_COMMAND='fd --type f --hidden --follow --exclude .git'
export FZF_CTRL_T_OPTS="--preview 'bat --style=numbers --color=always --line-range :200 {}'"

# thefuck
zinit ice wait lucid
zinit light laggardkernel/zsh-thefuck

# zoxide
zinit ice wait"1" as"command" from"gh-r" bpick"*aarch64*" lucid \
  mv"zoxide* -> zoxide" \
  atclone"./zoxide init zsh > init.zsh" \
  atpull"%atclone" src"init.zsh" nocompile'!'
zinit light ajeetdsouza/zoxide

# starship
zinit ice as"command" from"gh-r"  bpick"*aarch64*" \
          atclone"./starship init zsh > init.zsh; ./starship completions zsh > _starship" \
          atpull"%atclone" src"init.zsh"
zinit light starship/starship

autoload compinit
compinit

# alias
alias vim=nvim

# color
export CLICOLOR=1;

function coalesce { print "${${(s: :)@}[1]}" }
export OBJC_DISABLE_INITIALIZE_FORK_SAFETY=YES

export LDFLAGS="-L/usr/local/opt/openssl/lib"
export CPPFLAGS="-I/usr/local/opt/openssl/include"

alias tmux='direnv exec / tmux'

# history
HISTSIZE=999999999
SAVEHIST=999999999
setopt    appendhistory
setopt    sharehistory
setopt    incappendhistory

. /opt/homebrew/opt/asdf/libexec/asdf.sh
alias tailscale="/Applications/Tailscale.app/Contents/MacOS/Tailscale"

alias qr='qrencode -m 2 -t utf8 <<< "$1"'
eval "$(op completion zsh)"; compdef _op op

export XDG_CONFIG_HOME="$HOME/.config"
